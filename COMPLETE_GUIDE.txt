# Complete Guide: Building and Deploying an AI Coding Agent

## Project Overview
This guide documents the complete process of building a production-ready AI coding agent with Slack integration, from scratch to deployment.

---

## Table of Contents
1. Project Setup
2. Core Development
3. GitHub Integration
4. Railway Deployment
5. Slack Configuration
6. Testing and Troubleshooting
7. Final Steps

---

## PART 1: PROJECT SETUP

### Step 1.1: Create Project Structure
```bash
mkdir coding-agent
cd coding-agent
python3 -m venv venv
source venv/bin/activate
```

### Step 1.2: Initialize Git
```bash
git init
git branch -m main
git config user.name "Your Name"
git config user.email "your@email.com"
```

### Step 1.3: Create Directory Structure
```bash
mkdir -p src/{agent,slack,gh_integration,scraper} tests docs
touch src/__init__.py
touch src/agent/__init__.py
touch src/slack/__init__.py
touch src/gh_integration/__init__.py
touch src/scraper/__init__.py
```

### Step 1.4: Create requirements.txt
```
anthropic>=0.40.0
langchain>=0.3.0
langchain-anthropic>=0.3.0
slack-bolt>=1.18.0
PyGithub>=2.1.1
python-dotenv>=1.0.0
requests>=2.31.0
beautifulsoup4>=4.12.0
firecrawl-py>=0.0.5
```

### Step 1.5: Install Dependencies
```bash
pip install -r requirements.txt
```

---

## PART 2: CORE DEVELOPMENT

### Step 2.1: Create Coding Agent (src/agent/coding_agent.py)

**Purpose**: Interface with Claude AI for code generation

**Key Components**:
- Initialize Claude API client
- Methods for code generation, doc analysis, issue solving
- Error handling

**Important Notes**:
- Use Claude 3.5 Sonnet model
- Set temperature=0 for consistent output
- Include system prompts for better results

### Step 2.2: Create Documentation Scraper (src/scraper/doc_scraper.py)

**Purpose**: Scrape documentation from URLs

**Key Components**:
- Firecrawl API integration (optional)
- BeautifulSoup fallback (always works)
- Text cleaning and extraction

**Important Notes**:
- Firecrawl is optional - BeautifulSoup is the fallback
- Remove script/style tags for clean text
- Handle errors gracefully

### Step 2.3: Create GitHub Manager (src/gh_integration/github_manager.py)

**Purpose**: Interact with GitHub API

**Key Components**:
- Get repository and issues
- Create branches and PRs
- Update files

**Important Notes**:
- CRITICAL: Name folder `gh_integration`, NOT `github` (naming conflict with PyGithub library)
- Use PyGithub library
- Handle authentication with tokens

### Step 2.4: Create Slack Bot (src/slack/slack_bot.py)

**Purpose**: Slack integration with Socket Mode

**Key Components**:
- Socket Mode handler
- Slash command handlers (/generate, /scrape, /solve)
- Message handlers

**Important Notes**:
- Use Socket Mode (not webhooks)
- Requires both Bot Token and App Token
- Commands are registered in Slack app settings, not code

### Step 2.5: Create Main Entry Point (src/main.py)

**Purpose**: Initialize and start all components

**Key Components**:
- Load environment variables
- Initialize agent, GitHub, scraper, bot
- Start bot with error handling

**Important Notes**:
- Use `flush=True` in print statements for Railway logs
- Add try-except for debugging
- Use relative imports (not `from src.`)

---

## PART 3: GITHUB INTEGRATION

### Step 3.1: Create GitHub Repository
1. Go to https://github.com/new
2. Repository name: `coding-agent`
3. Make it Public
4. DO NOT initialize with README (we have one)
5. Click "Create repository"

### Step 3.2: Generate GitHub Token
1. Go to https://github.com/settings/tokens
2. Generate new token (classic)
3. Select scopes: `repo` (full control)
4. Copy token (starts with `ghp_`)
5. Save it securely

### Step 3.3: Push to GitHub
```bash
git remote add origin https://github.com/YOUR_USERNAME/coding-agent.git
git add .
git commit -m "Initial commit"
git push -u origin main
```

**Important**: If push fails due to authentication:
- Use token as password
- Or set up SSH keys
- Or use GitHub CLI

---

## PART 4: RAILWAY DEPLOYMENT

### Step 4.1: Create Dockerfile

**Why**: Railway needs to know how to build and run the app

```dockerfile
FROM python:3.12-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt
COPY src/ ./src/
CMD ["python", "src/main.py"]
```

**Important Notes**:
- Use official Python image
- Copy requirements first (better caching)
- Don't use nixpacks (causes pip issues)

### Step 4.2: Create Railway Account
1. Go to https://railway.app
2. Sign up with GitHub
3. Verify email

### Step 4.3: Deploy from GitHub
1. Click "New Project"
2. Select "Deploy from GitHub repo"
3. Choose `coding-agent` repository
4. Click "Deploy"

### Step 4.4: Set Environment Variables

In Railway dashboard → Variables tab, add:

```
ANTHROPIC_API_KEY = sk-ant-xxxxx...
SLACK_BOT_TOKEN = xoxb-xxxxx...
SLACK_APP_TOKEN = xapp-xxxxx...
GITHUB_TOKEN = ghp_xxxxx...
GITHUB_REPO_OWNER = your_username
GITHUB_REPO_NAME = coding-agent
```

**Important**: Railway auto-redeploys when you add/change variables

---

## PART 5: SLACK CONFIGURATION

### Step 5.1: Create Slack App
1. Go to https://api.slack.com/apps
2. Click "Create New App"
3. Choose "From scratch"
4. App Name: `Coding Agent` (or any name)
5. Select your workspace
6. Click "Create App"

### Step 5.2: Enable Socket Mode
1. In left sidebar → "Socket Mode"
2. Toggle "Enable Socket Mode" to ON
3. Token name: `socket-token`
4. Click "Generate"
5. **COPY THE TOKEN** (starts with `xapp-`)
6. This is your `SLACK_APP_TOKEN`
7. Click "Done"

**Important**: Socket Mode requires App Token with `connections:write` scope

### Step 5.3: Add Bot Permissions
1. In left sidebar → "OAuth & Permissions"
2. Scroll to "Bot Token Scopes"
3. Click "Add an OAuth Scope"
4. Add these scopes:
   - `chat:write`
   - `commands`
   - `app_mentions:read`

### Step 5.4: Install App to Workspace
1. Still on "OAuth & Permissions" page
2. Scroll to top
3. Click "Install to Workspace"
4. Review permissions
5. Click "Allow"
6. **COPY THE BOT TOKEN** (starts with `xoxb-`)
7. This is your `SLACK_BOT_TOKEN`

### Step 5.5: Create Slash Commands
1. In left sidebar → "Slash Commands"
2. Click "Create New Command"

**Create these 3 commands**:

Command 1:
- Command: `/generate`
- Request URL: `https://example.com` (doesn't matter for Socket Mode)
- Short Description: `Generate code from requirements`
- Click "Save"

Command 2:
- Command: `/scrape`
- Request URL: `https://example.com`
- Short Description: `Scrape documentation from URL`
- Click "Save"

Command 3:
- Command: `/solve`
- Request URL: `https://example.com`
- Short Description: `Solve a GitHub issue by number`
- Click "Save"

**Important**: Request URL doesn't matter because we use Socket Mode

### Step 5.6: Add Bot to Channel
In Slack:
1. Go to any channel (e.g., #general)
2. Type: `/invite @Your Bot Name`
3. Press Enter
4. Bot joins the channel

**Important**: Bot must be in channel to respond to commands

---

## PART 6: TESTING AND TROUBLESHOOTING

### Step 6.1: Check Railway Logs
1. Go to Railway dashboard
2. Click "Deployments"
3. Click latest deployment
4. Check logs for:
   ```
   Starting Coding Agent...
   Coding agent initialized
   GitHub manager initialized
   Doc scraper initialized
   Slack bot initialized
   Connecting to Slack...
   ```

### Step 6.2: Test in Slack
In Slack channel where bot is added:
```
/generate Write a Python hello world function
```

**Expected**: Bot responds with generated code

### Step 6.3: Common Issues and Solutions

**Issue 1: "not_in_channel" error**
- Solution: Invite bot to channel with `/invite @bot`

**Issue 2: "invalid x-api-key" error**
- Solution: Anthropic API key is wrong/expired
- Fix: Generate new key at https://console.anthropic.com/settings/keys
- Update in Railway Variables

**Issue 3: Commands disappear, no response**
- Check: Bot is added to channel
- Check: Slash commands are created in Slack app
- Check: Railway logs show bot is running

**Issue 4: "ModuleNotFoundError: No module named 'src'"**
- Solution: Use relative imports in main.py
- Don't use `from src.agent` - use `from agent`

**Issue 5: "cannot import name 'Github' from 'github'"**
- Solution: Rename `src/github/` folder to `src/gh_integration/`
- This avoids conflict with PyGithub library

**Issue 6: Railway build fails with "pip: command not found"**
- Solution: Use Dockerfile instead of nixpacks
- Dockerfile ensures pip is available

---

## PART 7: FINAL STEPS

### Step 7.1: Get Anthropic API Key
1. Go to https://console.anthropic.com/
2. Sign up (get $5 free credit)
3. Go to "API Keys"
4. Click "Create Key"
5. Copy key (starts with `sk-ant-`)
6. Update in Railway Variables

### Step 7.2: Verify Everything Works
Test all commands:
```
/generate Write a function to calculate factorial
/scrape https://docs.python.org/3/
/solve 1
```

### Step 7.3: Monitor Usage
- Railway: Check deployment logs
- Anthropic: Monitor API usage at console.anthropic.com
- Slack: Check bot responses

---

## COMPLETE CHECKLIST

### Development:
- [x] Project structure created
- [x] Dependencies installed
- [x] Coding agent implemented
- [x] Doc scraper implemented
- [x] GitHub manager implemented
- [x] Slack bot implemented
- [x] Main entry point created

### GitHub:
- [x] Repository created
- [x] Code pushed
- [x] Token generated

### Railway:
- [x] Account created
- [x] Project deployed
- [x] Environment variables set
- [x] Dockerfile created
- [x] Build successful
- [x] Application running

### Slack:
- [x] App created
- [x] Socket Mode enabled
- [x] App Token generated
- [x] Bot permissions added
- [x] App installed to workspace
- [x] Bot Token generated
- [x] Slash commands created
- [x] Bot added to channel

### Testing:
- [ ] Anthropic API key valid
- [ ] Commands work in Slack
- [ ] Bot responds correctly

---

## KEY LEARNINGS

### 1. Naming Conflicts
- Don't name folders after Python libraries (e.g., `github`)
- Use descriptive names like `gh_integration`

### 2. Import Paths
- In Docker, use relative imports
- Add parent directory to sys.path if needed
- Don't use `from src.` in main.py

### 3. Slack Socket Mode
- Requires TWO tokens: Bot Token and App Token
- App Token needs `connections:write` scope
- Bot must be invited to channels
- Slash commands registered in Slack app, not code

### 4. Railway Deployment
- Use Dockerfile for reliability
- Add `flush=True` to print statements for logs
- Environment variables trigger auto-redeploy
- Check logs for debugging

### 5. Error Handling
- Always add try-except blocks
- Print errors with traceback
- Use flush=True for immediate log output

---

## COST BREAKDOWN

### Free Tier:
- GitHub: Free (public repos)
- Slack: Free (standard workspace)

### Paid Services:
- Railway: $5 credit/month (free tier)
  - Usage: ~$2-3/month for this project
- Anthropic Claude: Pay-as-you-go
  - ~$0.01-0.10 per request
  - $5 free credit for new accounts

**Total Monthly Cost**: $2-5

---

## MAINTENANCE

### Regular Tasks:
1. Monitor Railway logs for errors
2. Check Anthropic API usage
3. Update dependencies monthly
4. Rotate tokens every 90 days

### Updates:
```bash
# Update dependencies
pip install --upgrade -r requirements.txt

# Push updates
git add .
git commit -m "Update dependencies"
git push origin main

# Railway auto-deploys
```

---

## RESOURCES

### Documentation:
- Anthropic: https://docs.anthropic.com/
- Slack Bolt: https://slack.dev/bolt-python/
- PyGithub: https://pygithub.readthedocs.io/
- Railway: https://docs.railway.app/

### Support:
- Anthropic Discord: https://discord.gg/anthropic
- Slack API Community: https://slackcommunity.com/
- Railway Discord: https://discord.gg/railway

---

## NEXT STEPS

After completing this guide:

1. **Extend Functionality**:
   - Add more slash commands
   - Implement PR review features
   - Add code testing capabilities

2. **Improve Performance**:
   - Add caching for scraped docs
   - Implement rate limiting
   - Add request queuing

3. **Add Features**:
   - Multi-file code generation
   - Automated testing
   - Code review comments

4. **Scale**:
   - Add to multiple Slack workspaces
   - Support multiple GitHub repos
   - Add user authentication

---

## CONCLUSION

You've successfully built and deployed a production-ready AI coding agent!

**What You Learned**:
- Building AI agents with Claude
- Slack bot development with Socket Mode
- GitHub API integration
- Docker containerization
- Railway deployment
- Environment configuration
- Debugging production issues

**Time Investment**: ~5 hours
**Complexity**: Intermediate to Advanced
**Result**: Production-ready application

---

End of Guide

Created: February 5-6, 2026
Author: Built with Kiro AI Assistant
Project: AI Coding Agent with Slack Integration
